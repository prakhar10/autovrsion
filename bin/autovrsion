#!/usr/bin/env ruby

require 'listen'
require 'rugged'
require 'git'

require 'autovrsion/display_versions.rb'
require 'autovrsion/filelistener.rb'
require 'autovrsion/version_checkout.rb'
require 'autovrsion/create_repository.rb'
require 'autovrsion/reset.rb'
require 'autovrsion/rewind.rb'


f = FileListen.new
v = Checkout.new
c  = CreateRepo.new
r = Reset.new
rw = Rewind.new
d= DisplayLog.new

if ARGV[1] == nil
	path = Dir.pwd.to_s
	puts path
else
	path = ARGV[1].to_s
	puts path
end		

case ARGV[0]
	when "options"
		puts "\tdisplay - "
		puts "\tstart"
		puts "\tstop"
		puts "\tcheck"
		puts "\tcreate" 
		puts "\treset"
		puts "\trewind"
	when "help"
	h = File.open("autovrsion/help.txt")	
	while line = f.gets do
    	puts line
	end
	h.close	
	when "display"
		
		
		d.disp(path)
	when "start"
		
		puts "Listening to changes.enter "+"stop ".red+"or"+" 1 ".red+"to stop listening to changes"
		
		f.lis(path,"start")
	when "stop"
		#require 'autovrsion/filelistener.rb'
		#puts "Listening to changes.enter "+"stop ".red+"or"+" 1 ".red+"to stop listening to changes"
		
		f.lis(path,"stop")
				
	when "check"
		
		
		v.chk(path)
	when "create"
		
		
		c.create(path)
	when "reset"
		
		
		r.reset(path)
	when "rewind"
		
		
		rw.rewindto(path)
	end	


